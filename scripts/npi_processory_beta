import pandas as pd
import polars as pl

file_path = 'input/npidata_pfile_20050523-20250907.csv'

npi = pd.read_csv('input/npidata_pfile_20050523-20250907.csv')

npi.iloc[0]

npi.info()

npi.STATUS.value_counts
npi.CLASSTYPE.value_counts

npi.npi_NUM
npi.LONG_COMMON_NAME


list_cols = ['NPI', 'Provider Organization Name (Legal Business Name)', 'VProvider Last Name (Legal Name)']
print('list_cols')

subset = npi[list_cols]
print(subset.head())

npi_small = npi[['NPI', 'Provider Organization Name (Legal Business Name)', 'VProvider Last Name (Legal Name)']]
npi_small = npi[list_cols]

'NPI'=='code'
'Provider Organization Name (Legal Business Name)'=='description'
'VProvider Last Name (Legal Name)'=='last_name'

npi_small = npi_small.rename(columns={
    'NPI': 'code',
    'Provider Organization Name (Legal Business Name)': 'description',
    'VProvider Last Name (Legal Name)' : 'last_name'
})

file_output_path = 'NPI_small.csv'

npi_small.to_csv('output/NPI_small.csv')
