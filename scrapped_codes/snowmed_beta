### Code is functional, code kept as beta for SNOWMED.csv Generation. Primary difference is removal of printed information in terminal. 

import polars as pl
from pathlib import Path

file_path = Path('input\sct2_Description_Full-en_US1000124_20250901.txt')

df = pl.read_csv(
    file_path,
    separator=',',
    has_header=True,
    quote_char=None,
    encoding='utf8-lossy',
    truncate_ragged_lines=True,
    dtypes={
        'id': pl.Utf8,
        'effectiveTime': pl.Utf8,
        'term': pl.Utf8,
        
    }
)

output_dir = Path('output')
output_dir.mkdir(exist_ok=True)
output_path = output_dir / 'sct2_Description_Full.csv'

df.write_csv(output_path)

import pandas as pd 
file_path2= Path('output/sct2_Description_Full.csv')

###column_names = [
###     "Code", "Description1", "Description2" ]

###df = pd.read_fwf(file_path, colspecs=colspecs, names=column_names)


## save as csv to Module1_MedicalCodexes/hcpcs/output
###output_path = "output/hscps_output.csv"
### df.to_csv(output_path, index=False)


column = ['id', 'effectiveTime', 'active', 'moduleID', 'conceptId', 'languagecode', 'typeID', 'term', 'caseSignificanceId']
header = ['typeID' , 'term', 'caseSignificanceId' ]

output2_path = Path('output') 
df = pd.to_csv('snowmed.csv', columns=['typeID' , 'term', 'caseSignificanceId'], index=False)